---
title: "Regression Models Final Project"
author: "Lucas Falcao Monteiro"
date: "26/08/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,tidy.opts = list(width.cutoff = 60), tidy = TRUE)
```

# Analyzing fuel efficiency for automatic and manual transmission car models.

## Executive summary

## Introduction
Our work in the *Motor Trend* magazine includes analyzing technical details about automobiles. One question of interest to our readers is the efficiency of cars, as measures in miles per gallon, since fuel is a considerable cost of maintaining a vehicle. In this report we aim to discuss whether automatic cars are as efficient as those with manual transmission.

## Data collection
The data was extracted from our own collection, including 32 different 1973 and 1974 car models. Each observation contains 10 aspects, including the number of cylinders, horsepower, weight etc.

```{r}
data <- mtcars
names(data)
```

## Results
We tested various models and how additional predictors offered more information. We decided to adjust for the number of cylinders, horsepower and weight, and we find the following estimate and confidence interval for the influence of transmission type over fuel efficiency:

```{r}
summary(lm(mpg~am+hp+wt+cyl,data))$coef[2,]
confint(lm(mpg~am+hp+wt+cyl,data))[2,]
```
While there seems to be a small increase in fuel efficiency (1.48 miles per gallon) for manual transmission cars, the confidence interval includes 0. The p-value is 0.31, meaning there is a 31% chance of getting this result if we consider that there is no influence of the predictor on the outcome.


## Conclusion
We cannot conclude from this data that transmission type significantly improves fuel efficiency for vehicles when controlling for weight, number of cylinders and horsepower. However, our dataset is pretty small (32 observations), so a better analysis would be performed over a larger dataset, perhaps with hundreds of vehicles.


## Appendix
The entries indicate whether the transmission is automatic (0) or manual (1) in the 'am' column. We can plot a histogram of mpg for these two groups.
```{r}
library(ggplot2)

data$am <- as.factor(data$am)

g <- ggplot(data=data,aes(y=mpg,x=am,fill=am))
g + geom_boxplot() + scale_fill_brewer(palette='Blues') + scale_x_discrete(name='Transmission',labels=c('0'='automatic','1'='manual'))
```

It seems that manual transmission cars are more efficient than automatic ones. We can fit a linear model using transmission as a predictor for the outcome 'mpg' and check its significance.

```{r}
mdltrans <- lm(mpg~am,data)
summary(mdltrans)$coef
```

This preliminary model indicates there is a significant effect of transmission over fuel efficiency. However, this model might be biased because we are not correcting for other parameters that clearly affect efficiency, such as number of cylinders, horsepower and weight. Adding those into a separate model:

```{r}
mdl <- lm(mpg~am+cyl+hp+wt,data)
summary(mdl)$coef
```
Now we see that for a fixed number of cylinders, horsepower and weight, the change from automatic to manual transmission might increase the fuel efficiency by 1.5 miles per gallon. We can create several models and test the additional information each predictor adds to the model.

```{r}
mdl0 <- lm(mpg~am+cyl,data)
mdl1 <- lm(mpg~am+cyl+hp,data)
mdl2 <- lm(mpg~am+cyl+hp+wt,data)
mdl3 <- lm(mpg~am+cyl+hp+wt+qsec,data)
mdl4 <- lm(mpg~am+cyl+hp+wt+qsec+drat,data)
mdl5 <- lm(mpg~am+cyl+hp+wt+qsec+drat+disp,data)
mdl6 <- lm(mpg~am+cyl+hp+wt+qsec+drat+disp+vs,data)
mdl7 <- lm(mpg~am+cyl+hp+wt+qsec+drat+disp+vs+gear,data)
mdl8 <- lm(mpg~am+cyl+hp+wt+qsec+drat+disp+vs+gear+carb,data)

anova(mdltrans,mdl0,mdl1,mdl2,mdl3,mdl4,mdl5,mdl6,mdl7,mdl8)
```
Therefore, we confirm that adding the number of cylinders, the horsepower and the weight of the vehicles offers more information about the fuel efficiency. That would be model 2 in our code. Finding the confidence interval for the slope of the transmission in this model:

```{r}
confint(mdl2)
```
This confidence interval contains 0, so we cannot safely attest that transmission type affects fuel efficiency. 

Checking the residuals and other diagnostic plots:
```{r}
par(mfrow=c(2,2))
plot(mdl2)
```

We see that there are some models influencing the model, such as *Toyota Corolla*, *Toyota Corona*, *Chrysler Imperial* and *Fiat 128*. We can try to remove those points and evaluate the effect over the model.

```{r}
 data$car <- rownames(data)
data1 <- data[!(data$car %in% c('Toyota Corolla','Toyota Corona','Chrysler Imperial','Fiat 128')),]
mdlnew <- lm(mpg~am+cyl+hp+wt,data1)
confint(mdlnew)

```

In this case, the center of the distribution is closer to 0, indicating an even less pronounced effect of transmission over fuel efficiency. 